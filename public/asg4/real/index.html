<!DOCTYPE html>
<html lang="en"><meta charset="utf-8" />

  <title>Assignment 4: Part 2 - Lorenzo X. Van Muñoz</title>


<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="https://lxvm.github.io/ph121c/css/latex.css" />
<link rel="stylesheet" href="https://lxvm.github.io/ph121c/css/main.css" />
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ["\\(", "\\)"]]
    }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<meta name="generator" content="Hugo 0.80.0" /><body>


<header>
  <div class="intro-header">
    <div class="container">
      <div class="asg4-heading">
        
          <h1>Assignment 4: Part 2</h1>
        
      </div>
    </div>
  </div>
</header>

        <div id="content">
  <div class="container" role="main">
    <article class="article" class="blog-post">
      <div class="postmeta">
        <span class="meta-post">
  
</span>

      </div>
      <br>
      <h1 id="real-time-evolution">Real Time Evolution</h1>
<p>$\require{physics}$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> copy <span style="color:#f92672">import</span> deepcopy

<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">from</span> scipy.linalg <span style="color:#f92672">import</span> expm
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">%</span>matplotlib inline

<span style="color:#f92672">from</span> ph121c_lxvm <span style="color:#f92672">import</span> tensor, measure
</code></pre></div><h2 id="summary">Summary</h2>
<p>In this notebook, we will evolve a quantum state
\begin{align}
\ket{\psi(t=0)} = \ket{\xi} \otimes \cdots \otimes \ket{\xi}
,
\end{align}
where $\ket{\xi} = \frac{1}{2} \left( \ket{\uparrow} - \sqrt{3} \ket{\downarrow} \right)$.
We will also evolve a second product state to compare against:
\begin{align}
\ket{\psi (t=0)}
&amp;= \ket{\uparrow} \otimes \ket{\downarrow} \otimes \cdots
.
\end{align}</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Build initial state</span>
down <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1.</span>, <span style="color:#ae81ff">0.</span>])<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
up   <span style="color:#f92672">=</span> down[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>reshape((<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>))
<span style="color:#960050;background-color:#1e0010">ξ</span> <span style="color:#f92672">=</span> (up <span style="color:#f92672">-</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">3</span>) <span style="color:#f92672">*</span> down) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">make_waves</span> (L, d):
    <span style="color:#e6db74">&#34;&#34;&#34;Create the inital wavefunctions.&#34;&#34;&#34;</span>
    <span style="color:#960050;background-color:#1e0010">ψ</span> <span style="color:#f92672">=</span> tensor<span style="color:#f92672">.</span>mps(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
    <span style="color:#960050;background-color:#1e0010">ψ</span><span style="color:#f92672">.</span>from_arr([ <span style="color:#960050;background-color:#1e0010">ξ</span> <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(L) ], center<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)
    <span style="color:#66d9ef">assert</span> (L <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
    <span style="color:#960050;background-color:#1e0010">ρ</span> <span style="color:#f92672">=</span> tensor<span style="color:#f92672">.</span>mps(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
    wave <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(L <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span>):
        wave<span style="color:#f92672">.</span>append(up)
        wave<span style="color:#f92672">.</span>append(down)
    <span style="color:#960050;background-color:#1e0010">ρ</span><span style="color:#f92672">.</span>from_arr(wave, center<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)    
    <span style="color:#66d9ef">return</span> (<span style="color:#960050;background-color:#1e0010">ψ</span>, <span style="color:#960050;background-color:#1e0010">ρ</span>)
</code></pre></div><p>We will do so while measuring the half-system entanglement entropy, $S_{L/2}$:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">eentropy</span> (tren, i):
    <span style="color:#e6db74">&#34;&#34;&#34;Calculate the entanglement entropy at a cut between quanta i, i+1.&#34;&#34;&#34;</span>
    tren<span style="color:#f92672">.</span>groupby_quanta_tag([i])
    u, s, vh <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>svd(tren<span style="color:#f92672">.</span>center<span style="color:#f92672">.</span>mat)
    <span style="color:#66d9ef">return</span> measure<span style="color:#f92672">.</span>entropy<span style="color:#f92672">.</span>entanglement(s)

</code></pre></div><p>and these observables
$\ev{\sigma_{L/2}^x}, \ev{\sigma_1^x}, \ev{\sigma_{L/2}^z}, \ev{\sigma_1^z}$:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sx <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>]])
sy <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([[<span style="color:#ae81ff">0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1j</span>], [<span style="color:#ae81ff">1j</span>, <span style="color:#ae81ff">0</span>]])
sz <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>diag([<span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">make_observables</span> (L, d):
    <span style="color:#e6db74">&#34;&#34;&#34;Create the observable operators of interest.&#34;&#34;&#34;</span>
    s1x <span style="color:#f92672">=</span> tensor<span style="color:#f92672">.</span>mpo(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
    s1x<span style="color:#f92672">.</span>set_local_oper(sx, <span style="color:#ae81ff">1</span>)
    sL2x <span style="color:#f92672">=</span> tensor<span style="color:#f92672">.</span>mpo(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
    sL2x<span style="color:#f92672">.</span>set_local_oper(sx, L<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>)
    s1z <span style="color:#f92672">=</span> tensor<span style="color:#f92672">.</span>mpo(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
    s1z<span style="color:#f92672">.</span>set_local_oper(sz, <span style="color:#ae81ff">1</span>)
    sL2z <span style="color:#f92672">=</span> tensor<span style="color:#f92672">.</span>mpo(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
    sL2z<span style="color:#f92672">.</span>set_local_oper(sz, L<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>)
    <span style="color:#66d9ef">return</span> (s1x, sL2x, s1z, sL2z)
</code></pre></div><p>We will consider the same Hamiltonian as before, now evolving in real time:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Build pieces of Hamiltonian in gate representation</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build_pieces_of_H</span> (L, d, hx, hz):
    <span style="color:#e6db74">&#34;&#34;&#34;Build the field, odd, and even term Hamiltonians and also their union.&#34;&#34;&#34;</span>
    H_field <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(L, dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;O&#39;</span>)
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(H_field<span style="color:#f92672">.</span>size):
        H_field[i] <span style="color:#f92672">=</span> tensor<span style="color:#f92672">.</span>mpo(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
        H_field[i]<span style="color:#f92672">.</span>set_local_oper(<span style="color:#f92672">-</span>(hx <span style="color:#f92672">*</span> sx <span style="color:#f92672">+</span> hz <span style="color:#f92672">*</span> sz), i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
    H_odd <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(L<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>, dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;O&#39;</span>)
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(H_odd<span style="color:#f92672">.</span>size):
        H_odd[i] <span style="color:#f92672">=</span> tensor<span style="color:#f92672">.</span>mpo(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
        H_odd[i]<span style="color:#f92672">.</span>set_local_oper(<span style="color:#f92672">-</span>sz, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
        H_odd[i]<span style="color:#f92672">.</span>set_local_oper(sz, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
    H_even <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(L<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> L<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>, dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;O&#39;</span>)
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(H_even<span style="color:#f92672">.</span>size):
        H_even[i] <span style="color:#f92672">=</span> tensor<span style="color:#f92672">.</span>mpo(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
        H_even[i]<span style="color:#f92672">.</span>set_local_oper(<span style="color:#f92672">-</span>sz, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>(i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>))
        H_even[i]<span style="color:#f92672">.</span>set_local_oper(sz, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>(i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
    H_full <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#f92672">*</span>H_field, <span style="color:#f92672">*</span>H_odd, <span style="color:#f92672">*</span>H_even], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;O&#39;</span>)
    <span style="color:#66d9ef">return</span> (H_field, H_odd, H_even, H_full)


<span style="color:#75715e"># Construct propagators</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build_propagators</span> (L, d, <span style="color:#960050;background-color:#1e0010">δτ</span>, H_field, H_odd, H_even):
    <span style="color:#e6db74">&#34;&#34;&#34;Exponentiate each non-commuting piece of the Hamiltonian&#34;&#34;&#34;</span>
    U_field <span style="color:#f92672">=</span> tensor<span style="color:#f92672">.</span>mpo(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
    <span style="color:#66d9ef">for</span> i, e <span style="color:#f92672">in</span> enumerate(H_field):
        U_field<span style="color:#f92672">.</span>set_local_oper(expm(<span style="color:#f92672">-</span> <span style="color:#ae81ff">1.j</span> <span style="color:#f92672">*</span> <span style="color:#960050;background-color:#1e0010">δτ</span> <span style="color:#f92672">*</span> e[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>mat), i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
    U_odd <span style="color:#f92672">=</span> tensor<span style="color:#f92672">.</span>mpo(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
    <span style="color:#66d9ef">for</span> i, e <span style="color:#f92672">in</span> enumerate(H_odd):
        U_odd<span style="color:#f92672">.</span>set_local_oper(
            expm(<span style="color:#f92672">-</span> <span style="color:#ae81ff">1.j</span> <span style="color:#f92672">*</span> <span style="color:#960050;background-color:#1e0010">δτ</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>kron(e[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>mat, e[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>mat)),
            <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
        )
    U_even <span style="color:#f92672">=</span> tensor<span style="color:#f92672">.</span>mpo(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
    <span style="color:#66d9ef">for</span> i, e <span style="color:#f92672">in</span> enumerate(H_even):
        U_even<span style="color:#f92672">.</span>set_local_oper(
            expm(<span style="color:#f92672">-</span> <span style="color:#ae81ff">1.j</span> <span style="color:#f92672">*</span> <span style="color:#960050;background-color:#1e0010">δτ</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>kron(e[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>mat, e[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>mat)),
            <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> (i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
        )
    <span style="color:#66d9ef">return</span> (U_field, U_odd, U_even)


</code></pre></div><p>Our goal is to observe how quickly the entanglement entropy grows in time
in order to observe the limitations of the validity of our MPS approximation.</p>
<h2 id="evolution">Evolution</h2>
<p>We will evolve the aforementioned states at the system sizes $L=16, 32$
for a fixed number $N=20$ of time steps at a step size of $\delta\tau=0.05$.
At each time step, we measure the entropy and the observables.</p>
<p>It would be nice to do a bigger system, but I already demonstrated that
my implementation can do these MPS systems up to a size of 100, albeit
slowly. I would need MOAR PERFORMANCE to consider letting these big
simulations run for bigger chunks time.</p>
<p>I wrote code that tried to be general, rather than specific.
I suppose there&rsquo;s a performance penalty for all of my argument checking.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">d <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
hx <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.05</span>
hz <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.05</span>
<span style="color:#960050;background-color:#1e0010">δτ</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.05</span>
N <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%%</span>time
chi_vals <span style="color:#f92672">=</span> [<span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">64</span>]
L_list <span style="color:#f92672">=</span> [<span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">32</span>]
<span style="color:#75715e"># Data structure to save results</span>
<span style="color:#960050;background-color:#1e0010">ψ</span>_results <span style="color:#f92672">=</span> dict(t<span style="color:#f92672">=</span>[], L<span style="color:#f92672">=</span>[], S<span style="color:#f92672">=</span>[], s1x<span style="color:#f92672">=</span>[], sL2x<span style="color:#f92672">=</span>[], s1z<span style="color:#f92672">=</span>[], sL2z<span style="color:#f92672">=</span>[], chi<span style="color:#f92672">=</span>[])
<span style="color:#960050;background-color:#1e0010">ρ</span>_results <span style="color:#f92672">=</span> dict(t<span style="color:#f92672">=</span>[], L<span style="color:#f92672">=</span>[], S<span style="color:#f92672">=</span>[], s1x<span style="color:#f92672">=</span>[], sL2x<span style="color:#f92672">=</span>[], s1z<span style="color:#f92672">=</span>[], sL2z<span style="color:#f92672">=</span>[], chi<span style="color:#f92672">=</span>[])
<span style="color:#66d9ef">for</span> L <span style="color:#f92672">in</span> L_list:
    <span style="color:#66d9ef">for</span> chi <span style="color:#f92672">in</span> chi_vals:
        H_field, H_odd, H_even, H_full <span style="color:#f92672">=</span> build_pieces_of_H(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d, hx<span style="color:#f92672">=</span>hx, hz<span style="color:#f92672">=</span>hz)
        U_field, U_odd, U_even <span style="color:#f92672">=</span> build_propagators(
            L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d, <span style="color:#960050;background-color:#1e0010">δτ</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">δτ</span>, H_field<span style="color:#f92672">=</span>H_field, H_odd<span style="color:#f92672">=</span>H_odd, H_even<span style="color:#f92672">=</span>H_even
        )
        <span style="color:#960050;background-color:#1e0010">ψ</span>, <span style="color:#960050;background-color:#1e0010">ρ</span> <span style="color:#f92672">=</span> make_waves(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
        s1x, sL2x, s1z, sL2z <span style="color:#f92672">=</span> make_observables(L<span style="color:#f92672">=</span>L, d<span style="color:#f92672">=</span>d)
        <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;t&#39;</span>]<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">0</span>)
        <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;chi&#39;</span>]<span style="color:#f92672">.</span>append(chi)
        <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;L&#39;</span>]<span style="color:#f92672">.</span>append(L)
        <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;S&#39;</span>]<span style="color:#f92672">.</span>append(eentropy(<span style="color:#960050;background-color:#1e0010">ψ</span>, L<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>))
        <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;s1x&#39;</span>]<span style="color:#f92672">.</span>append(s1x<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ψ</span>))
        <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;sL2x&#39;</span>]<span style="color:#f92672">.</span>append(sL2x<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ψ</span>))
        <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;s1z&#39;</span>]<span style="color:#f92672">.</span>append(s1z<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ψ</span>))
        <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;sL2z&#39;</span>]<span style="color:#f92672">.</span>append(sL2z<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ψ</span>))
        <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;t&#39;</span>]<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">0</span>)
        <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;chi&#39;</span>]<span style="color:#f92672">.</span>append(chi)
        <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;L&#39;</span>]<span style="color:#f92672">.</span>append(L)
        <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;S&#39;</span>]<span style="color:#f92672">.</span>append(eentropy(<span style="color:#960050;background-color:#1e0010">ρ</span>, L<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>))
        <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;s1x&#39;</span>]<span style="color:#f92672">.</span>append(s1x<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ρ</span>))
        <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;sL2x&#39;</span>]<span style="color:#f92672">.</span>append(sL2x<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ρ</span>))
        <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;s1z&#39;</span>]<span style="color:#f92672">.</span>append(s1z<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ρ</span>))
        <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;sL2z&#39;</span>]<span style="color:#f92672">.</span>append(sL2z<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ρ</span>))
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N):
            <span style="color:#66d9ef">for</span> e <span style="color:#f92672">in</span> [U_field, U_even, U_odd]:
                e<span style="color:#f92672">.</span>oper(<span style="color:#960050;background-color:#1e0010">ψ</span>, inplace<span style="color:#f92672">=</span>True)
                e<span style="color:#f92672">.</span>oper(<span style="color:#960050;background-color:#1e0010">ρ</span>, inplace<span style="color:#f92672">=</span>True)
            <span style="color:#960050;background-color:#1e0010">ψ</span><span style="color:#f92672">.</span>trim_bonds(chi)
            <span style="color:#960050;background-color:#1e0010">ρ</span><span style="color:#f92672">.</span>trim_bonds(chi)
            <span style="color:#960050;background-color:#1e0010">ψ</span><span style="color:#f92672">.</span>normalize()
            <span style="color:#960050;background-color:#1e0010">ρ</span><span style="color:#f92672">.</span>normalize()
            <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;t&#39;</span>]<span style="color:#f92672">.</span>append(<span style="color:#960050;background-color:#1e0010">δτ</span> <span style="color:#f92672">*</span> (i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>))
            <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;chi&#39;</span>]<span style="color:#f92672">.</span>append(chi)
            <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;L&#39;</span>]<span style="color:#f92672">.</span>append(L)
            <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;S&#39;</span>]<span style="color:#f92672">.</span>append(eentropy(<span style="color:#960050;background-color:#1e0010">ψ</span>, L<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>))
            <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;s1x&#39;</span>]<span style="color:#f92672">.</span>append(s1x<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ψ</span>))
            <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;sL2x&#39;</span>]<span style="color:#f92672">.</span>append(sL2x<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ψ</span>))
            <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;s1z&#39;</span>]<span style="color:#f92672">.</span>append(s1z<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ψ</span>))
            <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;sL2z&#39;</span>]<span style="color:#f92672">.</span>append(sL2z<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ψ</span>))
            <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;t&#39;</span>]<span style="color:#f92672">.</span>append(<span style="color:#960050;background-color:#1e0010">δτ</span> <span style="color:#f92672">*</span> (i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>))
            <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;chi&#39;</span>]<span style="color:#f92672">.</span>append(chi)
            <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;L&#39;</span>]<span style="color:#f92672">.</span>append(L)
            <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;S&#39;</span>]<span style="color:#f92672">.</span>append(eentropy(<span style="color:#960050;background-color:#1e0010">ρ</span>, L<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>))
            <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;s1x&#39;</span>]<span style="color:#f92672">.</span>append(s1x<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ρ</span>))
            <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;sL2x&#39;</span>]<span style="color:#f92672">.</span>append(sL2x<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ρ</span>))
            <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;s1z&#39;</span>]<span style="color:#f92672">.</span>append(s1z<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ρ</span>))
            <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;sL2z&#39;</span>]<span style="color:#f92672">.</span>append(sL2z<span style="color:#f92672">.</span>expval(<span style="color:#960050;background-color:#1e0010">ρ</span>))
            <span style="color:#66d9ef">if</span> ((i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>):
                <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#39;step {i+1} completed at L={L}, chi={chi}&#39;</span>)
</code></pre></div><pre><code>step 10 completed at L=16, chi=16
step 20 completed at L=16, chi=16
step 10 completed at L=16, chi=32
step 20 completed at L=16, chi=32
step 10 completed at L=16, chi=64
step 20 completed at L=16, chi=64
step 10 completed at L=32, chi=16
step 20 completed at L=32, chi=16
step 10 completed at L=32, chi=32
step 20 completed at L=32, chi=32
step 10 completed at L=32, chi=64
step 20 completed at L=32, chi=64
CPU times: user 3h 18min 35s, sys: 2min 8s, total: 3h 20min 44s
Wall time: 35min 49s
</code></pre>
<h2 id="plots">Plots</h2>
<p>Here we will plot all of the observables we have recorded</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;chi&#39;</span>] <span style="color:#f92672">=</span> []
<span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;chi&#39;</span>] <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> L <span style="color:#f92672">in</span> L_list:
    <span style="color:#66d9ef">for</span> chi <span style="color:#f92672">in</span> chi_vals:
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
            <span style="color:#960050;background-color:#1e0010">ψ</span>_results[<span style="color:#e6db74">&#39;chi&#39;</span>]<span style="color:#f92672">.</span>append(chi)
            <span style="color:#960050;background-color:#1e0010">ρ</span>_results[<span style="color:#e6db74">&#39;chi&#39;</span>]<span style="color:#f92672">.</span>append(chi)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(<span style="color:#960050;background-color:#1e0010">ψ</span>_results)
dp <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(<span style="color:#960050;background-color:#1e0010">ρ</span>_results)
</code></pre></div><p>Let&rsquo;s first show the entropies for different values of $\chi$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">nrow, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>
fig, axes <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(nrow, ncol)
<span style="color:#66d9ef">for</span> i, row <span style="color:#f92672">in</span> enumerate(axes):
    dd <span style="color:#f92672">=</span> [df, dp][i]
    names <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;psi&#39;</span>, <span style="color:#e6db74">&#39;rho&#39;</span>)
    <span style="color:#66d9ef">for</span> j, ax <span style="color:#f92672">in</span> enumerate(row):
        <span style="color:#66d9ef">for</span> k, chi <span style="color:#f92672">in</span> enumerate(chi_vals):
            which <span style="color:#f92672">=</span> (dd<span style="color:#f92672">.</span>L <span style="color:#f92672">==</span> L_list[j]) <span style="color:#f92672">&amp;</span> (dd<span style="color:#f92672">.</span>chi <span style="color:#f92672">==</span> chi)
            ax<span style="color:#f92672">.</span>plot(
                dd<span style="color:#f92672">.</span>t[which]<span style="color:#f92672">.</span>values, dd<span style="color:#f92672">.</span>S[which]<span style="color:#f92672">.</span>values,
                label<span style="color:#f92672">=</span>f<span style="color:#e6db74">&#39;$</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">chi={chi}$&#39;</span>
            )
            ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;$S_{L/2}$ of $</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> names[i] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;, L=&#39;</span> <span style="color:#f92672">+</span> str(L_list[j]) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;$&#39;</span>)
            ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;time&#39;</span>)
            ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;$S_{L/2}$&#39;</span>)
            ax<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;right&#39;</span>)
fig<span style="color:#f92672">.</span>tight_layout()
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="output_18_0.png" alt="png"></p>
<p>Seems like the entropies grow rapidly until they hit a peak.
What happens afterwards depends on the system size and $\chi$, but
it is clear that either the entropies saturate at some large value, or
they crash down violently to zero.</p>
<p>Now we can just make plots for each observable</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">nrow, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>
fig, axes <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(nrow, ncol)
<span style="color:#66d9ef">for</span> i, row <span style="color:#f92672">in</span> enumerate(axes):
    dd <span style="color:#f92672">=</span> [df, dp][i]
    names <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;psi&#39;</span>, <span style="color:#e6db74">&#39;rho&#39;</span>)
    <span style="color:#66d9ef">for</span> j, ax <span style="color:#f92672">in</span> enumerate(row):
        <span style="color:#66d9ef">for</span> k, chi <span style="color:#f92672">in</span> enumerate(chi_vals):
            which <span style="color:#f92672">=</span> (dd<span style="color:#f92672">.</span>L <span style="color:#f92672">==</span> L_list[j]) <span style="color:#f92672">&amp;</span> (dd<span style="color:#f92672">.</span>chi <span style="color:#f92672">==</span> chi)
            ax<span style="color:#f92672">.</span>plot(
                dd<span style="color:#f92672">.</span>t[which]<span style="color:#f92672">.</span>values, np<span style="color:#f92672">.</span>real(dd<span style="color:#f92672">.</span>s1x[which]<span style="color:#f92672">.</span>values),
                label<span style="color:#f92672">=</span>f<span style="color:#e6db74">&#39;$</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">chi={chi}$&#39;</span>
            )
            ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;$</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">sigma_1^x$ of $</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> names[i] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;, L=&#39;</span> <span style="color:#f92672">+</span> str(L_list[j]) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;$&#39;</span>)
            ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;time&#39;</span>)
            ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;$</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">langle </span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">sigma_{1}^x </span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">rangle$&#39;</span>)
            ax<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;right&#39;</span>)
fig<span style="color:#f92672">.</span>tight_layout()
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="output_20_0.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">nrow, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>
fig, axes <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(nrow, ncol)
<span style="color:#66d9ef">for</span> i, row <span style="color:#f92672">in</span> enumerate(axes):
    dd <span style="color:#f92672">=</span> [df, dp][i]
    names <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;psi&#39;</span>, <span style="color:#e6db74">&#39;rho&#39;</span>)
    <span style="color:#66d9ef">for</span> j, ax <span style="color:#f92672">in</span> enumerate(row):
        <span style="color:#66d9ef">for</span> k, chi <span style="color:#f92672">in</span> enumerate(chi_vals):
            which <span style="color:#f92672">=</span> (dd<span style="color:#f92672">.</span>L <span style="color:#f92672">==</span> L_list[j]) <span style="color:#f92672">&amp;</span> (dd<span style="color:#f92672">.</span>chi <span style="color:#f92672">==</span> chi)
            ax<span style="color:#f92672">.</span>plot(
                dd<span style="color:#f92672">.</span>t[which]<span style="color:#f92672">.</span>values, np<span style="color:#f92672">.</span>real(dd<span style="color:#f92672">.</span>sL2x[which]<span style="color:#f92672">.</span>values),
                label<span style="color:#f92672">=</span>f<span style="color:#e6db74">&#39;$</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">chi={chi}$&#39;</span>
            )
            ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;$</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">sigma_{L/2}^x$ of $</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> names[i] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;, L=&#39;</span> <span style="color:#f92672">+</span> str(L_list[j]) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;$&#39;</span>)
            ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;time&#39;</span>)
            ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;$</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">langle </span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">sigma_{L/2}^x </span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">rangle$&#39;</span>)
            ax<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;right&#39;</span>)
fig<span style="color:#f92672">.</span>tight_layout()
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="output_21_0.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">nrow, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>
fig, axes <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(nrow, ncol)
<span style="color:#66d9ef">for</span> i, row <span style="color:#f92672">in</span> enumerate(axes):
    dd <span style="color:#f92672">=</span> [df, dp][i]
    names <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;psi&#39;</span>, <span style="color:#e6db74">&#39;rho&#39;</span>)
    <span style="color:#66d9ef">for</span> j, ax <span style="color:#f92672">in</span> enumerate(row):
        <span style="color:#66d9ef">for</span> k, chi <span style="color:#f92672">in</span> enumerate(chi_vals):
            which <span style="color:#f92672">=</span> (dd<span style="color:#f92672">.</span>L <span style="color:#f92672">==</span> L_list[j]) <span style="color:#f92672">&amp;</span> (dd<span style="color:#f92672">.</span>chi <span style="color:#f92672">==</span> chi)
            ax<span style="color:#f92672">.</span>plot(
                dd<span style="color:#f92672">.</span>t[which]<span style="color:#f92672">.</span>values, np<span style="color:#f92672">.</span>real(dd<span style="color:#f92672">.</span>s1z[which]<span style="color:#f92672">.</span>values),
                label<span style="color:#f92672">=</span>f<span style="color:#e6db74">&#39;$</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">chi={chi}$&#39;</span>
            )
            ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;$</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">sigma_1^z$ of $</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> names[i] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;, L=&#39;</span> <span style="color:#f92672">+</span> str(L_list[j]) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;$&#39;</span>)
            ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;time&#39;</span>)
            ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;$</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">langle </span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">sigma_{1}^z </span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">rangle$&#39;</span>)
            ax<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;right&#39;</span>)
fig<span style="color:#f92672">.</span>tight_layout()
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="output_22_0.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">nrow, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>
fig, axes <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(nrow, ncol)
<span style="color:#66d9ef">for</span> i, row <span style="color:#f92672">in</span> enumerate(axes):
    dd <span style="color:#f92672">=</span> [df, dp][i]
    names <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;psi&#39;</span>, <span style="color:#e6db74">&#39;rho&#39;</span>)
    <span style="color:#66d9ef">for</span> j, ax <span style="color:#f92672">in</span> enumerate(row):
        <span style="color:#66d9ef">for</span> k, chi <span style="color:#f92672">in</span> enumerate(chi_vals):
            which <span style="color:#f92672">=</span> (dd<span style="color:#f92672">.</span>L <span style="color:#f92672">==</span> L_list[j]) <span style="color:#f92672">&amp;</span> (dd<span style="color:#f92672">.</span>chi <span style="color:#f92672">==</span> chi)
            ax<span style="color:#f92672">.</span>plot(
                dd<span style="color:#f92672">.</span>t[which]<span style="color:#f92672">.</span>values, np<span style="color:#f92672">.</span>real(dd<span style="color:#f92672">.</span>sL2z[which]<span style="color:#f92672">.</span>values),
                label<span style="color:#f92672">=</span>f<span style="color:#e6db74">&#39;$</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">chi={chi}$&#39;</span>
            )
            ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;$</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">sigma_{L/2}^z$ of $</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> names[i] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;, L=&#39;</span> <span style="color:#f92672">+</span> str(L_list[j]) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;$&#39;</span>)
            ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;time&#39;</span>)
            ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;$</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">langle </span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">sigma_{L/2}^z </span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">rangle$&#39;</span>)
            ax<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;right&#39;</span>)
fig<span style="color:#f92672">.</span>tight_layout()
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="output_23_0.png" alt="png"></p>
<p>I&rsquo;m rather surprised there isn&rsquo;t as much oscillation as in the last
homework, but I checked that one I evolved for 40 seconds and here it is only 1.
In each case, the observables crash down to zero wherever the entropy
peaks.
It&rsquo;s really almost too obvious.
It seems like my solver is failing drastically instead of just making a poor approximation.</p>
<p>Anyway, the results seem to match for both test wavefunctions, so at least
the simulations are consistent.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
</code></pre></div>


      
    </article>
    
  </div>

        </div><footer>
  <div class="container">
    <p class="credits copyright">
      <p class="credits theme-by">
        <a href="https://lxvm.github.io/ph121c/">root</a>
      </p>
    </p>
  </div>
</footer>
</body>
</html>
