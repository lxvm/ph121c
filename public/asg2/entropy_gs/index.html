<!DOCTYPE html>
<html lang="en"><meta charset="utf-8" />

  <title>Assignment 2: Part 2 - Lorenzo X. Van Mu√±oz</title>


<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="https://lxvm.github.io/ph121c/css/latex.css" />
<link rel="stylesheet" href="https://lxvm.github.io/ph121c/css/main.css" />
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ["\\(", "\\)"]]
    }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<meta name="generator" content="Hugo 0.80.0" /><body>


<header>
  <div class="intro-header">
    <div class="container">
      <div class="asg2-heading">
        
          <h1>Assignment 2: Part 2</h1>
        
      </div>
    </div>
  </div>
</header>

        <div id="content">
  <div class="container" role="main">
    <article class="article" class="blog-post">
      <div class="postmeta">
        <span class="meta-post">
  
</span>

      </div>
      <br>
      <h1 id="entanglement-entropy-of-highly-excited-states">Entanglement entropy of highly excited states</h1>
<h2 id="introduction">Introduction</h2>
<p>We are interested in calculating the entanglement entropy for states at the
middle of the spectrum, which sparse solvers do not do well (though it is
ameliorated by transformations like shift-invert mode).
Instead, I will obtain states via dense diagonalization</p>
<h2 id="program">Program</h2>
<ul>
<li>Calculate wavefunctions at center of spectrum using dense solver</li>
<li>Repeat entropy calculations as in part 2</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> scipy.linalg <span style="color:#f92672">as</span> la
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">%</span>matplotlib inline

<span style="color:#f92672">from</span> ph121c_lxvm <span style="color:#f92672">import</span> tfim, basis, tests, measure, data
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%%</span>time
entropies <span style="color:#f92672">=</span> {
    <span style="color:#e6db74">&#39;L&#39;</span> : [],
    <span style="color:#e6db74">&#39;h&#39;</span> : [],
    <span style="color:#e6db74">&#39;l&#39;</span> : [],
    <span style="color:#e6db74">&#39;S&#39;</span> : [],
    <span style="color:#e6db74">&#39;bc&#39;</span>: [],
}

<span style="color:#66d9ef">for</span> oper_params <span style="color:#f92672">in</span> tests<span style="color:#f92672">.</span>tfim_sweep(
    L <span style="color:#f92672">=</span> list(range(<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">15</span>)),
    h <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0.3</span>],
    bc<span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;c&#39;</span>],
):
    job <span style="color:#f92672">=</span> dict(
        oper<span style="color:#f92672">=</span>tfim<span style="color:#f92672">.</span>z<span style="color:#f92672">.</span>H_dense,
        oper_params<span style="color:#f92672">=</span>oper_params,
        solver<span style="color:#f92672">=</span>la<span style="color:#f92672">.</span>eigh,
        solver_params<span style="color:#f92672">=</span>{ 
            <span style="color:#e6db74">&#39;subset_by_index&#39;</span> : list(np<span style="color:#f92672">.</span>array([<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>]) <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> (oper_params[<span style="color:#e6db74">&#39;L&#39;</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)),
        },
    )
    evals, evecs <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>jobs<span style="color:#f92672">.</span>obtain(<span style="color:#f92672">**</span>job)
        
    es <span style="color:#f92672">=</span> evecs[:, <span style="color:#ae81ff">5</span>]
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;using state with eigenvalue:&#39;</span>, evals[<span style="color:#ae81ff">5</span>])
    A <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> l <span style="color:#f92672">in</span> range(oper_params[<span style="color:#e6db74">&#39;L&#39;</span>]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
        A<span style="color:#f92672">.</span>append(l)
        entropies[<span style="color:#e6db74">&#39;S&#39;</span>]<span style="color:#f92672">.</span>append(
            measure<span style="color:#f92672">.</span>entropy<span style="color:#f92672">.</span>entanglement(
                basis<span style="color:#f92672">.</span>schmidt<span style="color:#f92672">.</span>values(es, A, oper_params[<span style="color:#e6db74">&#39;L&#39;</span>])
            )
        )
        entropies[<span style="color:#e6db74">&#39;l&#39;</span>]<span style="color:#f92672">.</span>append(l)
        entropies[<span style="color:#e6db74">&#39;L&#39;</span>]<span style="color:#f92672">.</span>append(oper_params[<span style="color:#e6db74">&#39;L&#39;</span>])
        entropies[<span style="color:#e6db74">&#39;h&#39;</span>]<span style="color:#f92672">.</span>append(oper_params[<span style="color:#e6db74">&#39;h&#39;</span>])
        entropies[<span style="color:#e6db74">&#39;bc&#39;</span>]<span style="color:#f92672">.</span>append(oper_params[<span style="color:#e6db74">&#39;bc&#39;</span>])

df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(entropies)
</code></pre></div><pre><code>using state with eigenvalue: 0.6
using state with eigenvalue: -0.255107460434849
using state with eigenvalue: 1.4196736589527976
using state with eigenvalue: 0.7000000000000011
using state with eigenvalue: 1.3541254488577767e-16
using state with eigenvalue: -0.5651924049830526
using state with eigenvalue: 0.5813865554288129
using state with eigenvalue: 0.5809819774954872
using state with eigenvalue: 1.227076422501945e-15
using state with eigenvalue: -0.5150533998116924
using state with eigenvalue: 0.00034525367950669615
CPU times: user 236 ms, sys: 12 ms, total: 248 ms
Wall time: 53.7 ms
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_script</span>(df, bc):
    <span style="color:#e6db74">&#34;&#34;&#34;Make the display plots.&#34;&#34;&#34;</span>
    L <span style="color:#f92672">=</span> sorted(set(df<span style="color:#f92672">.</span>L))
    h <span style="color:#f92672">=</span> sorted(set(df<span style="color:#f92672">.</span>h))
    w <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>

    fig_l, axes_l <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(len(L)<span style="color:#f92672">//</span>w<span style="color:#f92672">+</span>len(L)<span style="color:#f92672">%</span>w, w)
    <span style="color:#66d9ef">for</span> i, row <span style="color:#f92672">in</span> enumerate(axes_l):
        <span style="color:#66d9ef">for</span> j, ax <span style="color:#f92672">in</span> enumerate(row):
            <span style="color:#66d9ef">if</span> w<span style="color:#f92672">*</span>i <span style="color:#f92672">+</span> j <span style="color:#f92672">&lt;</span> len(L):
                <span style="color:#66d9ef">for</span> s <span style="color:#f92672">in</span> h:
                    sub <span style="color:#f92672">=</span> df[(df<span style="color:#f92672">.</span>h<span style="color:#f92672">==</span>s) <span style="color:#f92672">&amp;</span> (df<span style="color:#f92672">.</span>L<span style="color:#f92672">==</span>L[w<span style="color:#f92672">*</span>i<span style="color:#f92672">+</span>j]) <span style="color:#f92672">&amp;</span> (df<span style="color:#f92672">.</span>bc<span style="color:#f92672">==</span>bc)]
                    ax<span style="color:#f92672">.</span>plot(sub<span style="color:#f92672">.</span>l<span style="color:#f92672">.</span>values, sub<span style="color:#f92672">.</span>S<span style="color:#f92672">.</span>values, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;h=&#39;</span><span style="color:#f92672">+</span>str(s))
                ax<span style="color:#f92672">.</span>set_xlabel(f<span style="color:#e6db74">&#39;$l$ at $L={L[w*i+j]}$&#39;</span>)
                ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;$S$&#39;</span>)
                handles, labels <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>get_legend_handles_labels()
            <span style="color:#66d9ef">else</span>:
                ax<span style="color:#f92672">.</span>set_axis_off()
                ax<span style="color:#f92672">.</span>legend(handles, labels, loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;center&#39;</span>)
    st <span style="color:#f92672">=</span> fig_l<span style="color:#f92672">.</span>suptitle(<span style="color:#e6db74">&#39;Entanglement entropies&#39;</span>)
    fig_l<span style="color:#f92672">.</span>set_size_inches(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>)
    fig_l<span style="color:#f92672">.</span>tight_layout()
    st<span style="color:#f92672">.</span>set_y(<span style="color:#f92672">.</span><span style="color:#ae81ff">95</span>)
    fig_l<span style="color:#f92672">.</span>subplots_adjust(top<span style="color:#f92672">=.</span><span style="color:#ae81ff">9</span>)

    fig_L, ax_L <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots()
    <span style="color:#66d9ef">for</span> s <span style="color:#f92672">in</span> h:
        sub <span style="color:#f92672">=</span> df[(df<span style="color:#f92672">.</span>h<span style="color:#f92672">==</span>s) <span style="color:#f92672">&amp;</span> (df<span style="color:#f92672">.</span>l<span style="color:#f92672">==</span>df<span style="color:#f92672">.</span>L<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>) <span style="color:#f92672">&amp;</span> (df<span style="color:#f92672">.</span>bc<span style="color:#f92672">==</span>bc)]
        ax_L<span style="color:#f92672">.</span>plot(sub<span style="color:#f92672">.</span>L<span style="color:#f92672">.</span>values, sub<span style="color:#f92672">.</span>S<span style="color:#f92672">.</span>values, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;h=&#39;</span><span style="color:#f92672">+</span>str(s))
    ax_L<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Entanglement entropy at half-subsystem&#39;</span>)
    ax_L<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;$L$&#39;</span>)
    ax_L<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;$S$&#39;</span>)
    ax_L<span style="color:#f92672">.</span>legend()
    fig_L<span style="color:#f92672">.</span>set_size_inches(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>)

    <span style="color:#66d9ef">return</span> (fig_l, fig_L)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%%</span>capture
figs <span style="color:#f92672">=</span> plot_script(df, <span style="color:#e6db74">&#39;c&#39;</span>)
</code></pre></div><h2 id="results">Results</h2>
<p>The main goal is to observe a different scaling of entropy for a highly-excited
state which is not a band state.
In fact this is what we observe for the Hamiltonian in the ferromagnetic phase
and with periodic boundary conditions.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">figs[<span style="color:#ae81ff">0</span>]
</code></pre></div><p><img src="output_7_0.png" alt="png"></p>
<p>It really is different behavior than the constant for the area law in the band
states.
From smaller $L=4$ to larger systems, $L=14$, the same pattern emerges where
the entanglement entropy has a maximum at $\ell = L/2$ and appears to decay
linearly away from that maximum.</p>
<p>Next we how a summary of the growth of the entanglement entropy at half
subsystems for various $L$:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">figs[<span style="color:#ae81ff">1</span>]
</code></pre></div><p><img src="output_9_0.png" alt="png"></p>
<h2 id="discussion">Discussion</h2>
<p>Instead of observing a constant entanglement entropy with respect to subsystems,
as in the extremal eigenstates, the states at the center of the spectrum display
new behaviors: increasing entropy with respect to system size and also with
respect to subsystem size.
One might expect that the entropy increases at equipartition, and indeed, this
is what we are observing.
From this perspective, the excited states are more random than those at the bands.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
</code></pre></div>


      
    </article>
    
  </div>

        </div><footer>
  <div class="container">
    <p class="credits copyright">
      <p class="credits theme-by">
        <a href="https://lxvm.github.io/ph121c/">root</a>
      </p>
    </p>
  </div>
</footer>
</body>
</html>
